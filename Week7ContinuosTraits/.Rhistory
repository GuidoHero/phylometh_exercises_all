one.discrete.char <
library(ape) #utility fns
library(geiger) #utilty fns
library(OUwie)
library(fishtree)
library(dplyr)
library(tidyr)
continuous.data <- read.csv("D:/OneDrive - Pontificia Universidad Javeriana/Documents/NutritionalValuesFishes/Nutrients_EntireDataSet.csv")
tree <- fishtree_phylogeny(type="chronogram")
CleanData <- function(data, phylo) {
data$Species <- gsub(' ', '_' , continuous.data$Species)
data <- data %>%
group_by(Species) %>%
summarize(mean_Pr = mean(Pr)) %>%
drop_na()  %>%
filter(Species %in% phylo$tip.label)
trait <- as.numeric(data$mean_Pr)
names(trait) <- data$Species
datatree <- treedata(tree, trait)
return(datatree)
}
data <- CleanData(continuous.data, tree)
VisualizeData <- function(phy, data) {
phytools::contMap(phy, data)
}
#### This is how is fitted here
BM1
BM1 <- geiger::fitContinuous(data$phy, data$data, model="BM")
print(paste("The rate of evolution is", BM1$opt$sigsq, "in units of", "time"))
OU1 <- fitContinuous(data$phy, data$data, model="OU")
par(mfcol(c(1,2)))
plot(tree, show.tip.label=FALSE)
ou.tree <- rescale(tree, model="OU", OU1$opt$alpha)
plot(ou.tree)
AIC.BM1 <- AIC(BM1)
AIC.OU1 <- AIC(OU1)
delta.AIC.BM1 <- AIC.BM1 - min(AIC.BM1, AIC.OU1)
delta.AIC.OU1 <- AIC.OU1 - min(AIC.BM1, AIC.OU1)
##OUwie runs##
one.discrete.char <- as.numeric(data$data < mean(data$data))
one.discrete.char
labeled.tree <- data$phy
labeled.tree <- data$phy
nodeBased.OUMV <- OUwie(labeled.tree, data$data, model="OUMV", simmap.tree=FALSE, diagn=FALSE)
nodeBased.OUMV <- OUwie(data$tree, data$data, model="OUMV", simmap.tree=FALSE, diagn=FALSE)
OU1 <- fitContinuous(data$phy, data$data, model="OU")
par(mfcol(c(1,2)))
plot(tree, show.tip.label=FALSE)
ou.tree <- rescale(tree, model="OU", OU1$opt$alpha)
plot(ou.tree)
best.states
best.states
one.discrete.char <- as.numeric(data$data < mean(data$data))
reconstruction.info <- ace(one.discrete.char, data$phy, type="discrete", method="ML", CI=TRUE)
best.states <- colnames(reconstruction.info$lik.anc)[apply(reconstruction.info$lik.anc, 1, which.max)]
best.states
one.discrete.char
